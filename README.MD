# Dokumentacja Aplikacji PDF to CSV Converter

## Przegld Aplikacji

Aplikacja **PDF to CSV Converter** to narzdzie Streamlit, kt贸re umo偶liwia konwersj tabel z dokument贸w PDF do formatu CSV (Comma Separated Values) przy u偶yciu modelu jzykowego Gemini API. Aplikacja jest szczeg贸lnie przydatna do ekstrakcji danych tabelarycznych z raport贸w, zestawie i innych dokument贸w PDF.

**G贸wna funkcjonalno aplikacji:**

*   **Konwersja PDF do CSV:** Wykorzystuje model Gemini API do rozpoznawania i ekstrakcji danych tabelarycznych z dokument贸w PDF i przeksztacania ich w format CSV.
*   **Obsuga PDF z pliku i URL:** U偶ytkownik mo偶e przesa plik PDF z dysku lokalnego lub poda URL do dokumentu PDF online.
*   **Wyb贸r zakresu stron:** Mo偶liwo konwersji tylko okrelonego zakresu stron z dokumentu PDF.
*   **Wywietlanie tabeli w czasie rzeczywistym:** Wyniki konwersji s wywietlane w formie tabeli w aplikacji na bie偶co podczas przetwarzania.
*   **Pobieranie pliku CSV:** Wygenerowany plik CSV mo偶na pobra na dysk lokalny.
*   **Kontrola procesu:** Przyciski "Convert", "STOP" i "Od nowa" umo偶liwiaj kontrol nad procesem konwersji, zatrzymanie go i zresetowanie aplikacji.
*   **Wska藕niki postpu:** Aplikacja informuje o postpie konwersji, szacowanym czasie zakoczenia i prdkoci przetwarzania.
*   **Obsuga bd贸w:** Aplikacja informuje o bdach podczas odczytu PDF, konwersji lub parsowania CSV.

## Jak U偶ywa Aplikacji

Poni偶ej znajdziesz instrukcj krok po kroku, jak korzysta z aplikacji PDF to CSV Converter.

### 1. Uruchomienie Aplikacji

1.  **Upewnij si, 偶e masz zainstalowane wymagane biblioteki.** Jeli jeszcze tego nie zrobie, zainstaluj je za pomoc `pip`:
    ```bash
    pip install streamlit PyPDF2 requests python-dotenv google-generativeai pandas stqdm
    ```
2.  **Zapisz kod aplikacji** (dostarczony kod Python) do pliku, na przykad `pdf_to_csv_app.py`.
3.  **Uruchom aplikacj Streamlit** z poziomu terminala, przechodzc do katalogu, w kt贸rym zapisae plik i wykonujc polecenie:
    ```bash
    streamlit run pdf_to_csv_app.py
    ```
    Aplikacja powinna otworzy si w Twojej przegldarce internetowej.

### 2. Konfiguracja Klucza API Gemini

1.  **Uzyskaj klucz API Gemini.**  Jeli jeszcze go nie posiadasz, kliknij przycisk **"GET KEY"** w aplikacji. Zostaniesz przekierowany do Google AI Studio, gdzie mo偶esz utworzy klucz API.
2.  **Wprowad藕 klucz API.** W polu tekstowym **"Enter your Gemini API Key..."** wprowad藕 sw贸j klucz API Gemini. Mo偶esz r贸wnie偶 pozostawi to pole puste, jeli ustawie zmienn rodowiskow `GEMINI_API_KEY` zawierajc Tw贸j klucz.
3.  **Alternatywnie, ustaw zmienn rodowiskow.** Mo偶esz ustawi zmienn rodowiskow `GEMINI_API_KEY` w systemie operacyjnym, aby unikn koniecznoci wprowadzania klucza API za ka偶dym razem.

### 3. Wyb贸r 殴r贸da PDF

W aplikacji dostpne s dwie opcje wyboru 藕r贸da dokumentu PDF:

*   **Upload PDF file:**
    1.  Wybierz opcj **"Upload PDF file"**.
    2.  Kliknij **"Browse files"** i wybierz plik PDF z dysku lokalnego, kt贸ry chcesz przekonwertowa.

*   **Enter PDF URL:**
    1.  Wybierz opcj **"Enter PDF URL"**.
    2.  W polu tekstowym **"Enter PDF URL:"** wprowad藕 adres URL dokumentu PDF, kt贸ry chcesz przekonwertowa. Na przykad, dla raportu ENEA:
        ```
        https://operator.enea.pl/uploads-ev2/Operator/ospolce/raporty/Publikacja_podmiot%C3%B3w_31_12_2024r..pdf
        ```

### 4. Wyb贸r Zakresu Stron

1.  **Sprawd藕 liczb stron.** Po wczytaniu pliku PDF lub URL, aplikacja wywietli informacj o cakowitej liczbie stron w dokumencie.
2.  **Ustaw zakres stron.** W polach **"Start Page"** i **"End Page"** wprowad藕 numery stron, kt贸re chcesz przekonwertowa. Domylnie zakres jest ustawiony na cay dokument (od strony 1 do ostatniej strony). Mo偶esz dostosowa zakres, jeli chcesz przetworzy tylko cz dokumentu. Upewnij si, 偶e strona pocztkowa nie jest wiksza ni偶 strona kocowa.

### 5. Rozpoczcie Konwersji

1.  **Kliknij przycisk "Convert".** Po ustawieniu 藕r贸da PDF i zakresu stron, kliknij przycisk **"Convert"**, aby rozpocz proces konwersji.
2.  **Obserwuj postp.** Aplikacja wywietli pasek postpu, informacj o aktualnie przetwarzanej stronie, szacowany czas zakoczenia i prdko przetwarzania. Wyniki konwersji bd wywietlane w formie tabeli poni偶ej w czasie rzeczywistym.
3.  **Oczekiwanie na zakoczenie.** Proces konwersji mo偶e potrwa od kilku sekund do kilku minut, w zale偶noci od rozmiaru dokumentu PDF, liczby stron i szybkoci Gemini API. Po zakoczeniu konwersji, aplikacja wywietli komunikat **"Conversion complete."**.

### 6. Zatrzymywanie Konwersji

*   **Przycisk "STOP".** W trakcie konwersji mo偶esz w dowolnym momencie klikn przycisk **"STOP"**, aby przerwa proces. Aplikacja wywietli komunikat **"Conversion stopped by user."**.

### 7. Pobieranie Wynik贸w CSV

1.  **Kliknij przycisk "Download CSV".** Po zakoczeniu konwersji (lub jej zatrzymaniu), pojawi si przycisk **"Download CSV"**.
2.  **Zapisz plik CSV.** Kliknij przycisk **"Download CSV"** i zapisz wygenerowany plik CSV (`result.csv`) na dysku lokalnym. Plik CSV bdzie zawiera dane tabelaryczne wyekstrahowane z dokumentu PDF.

### 8. Resetowanie Aplikacji

*   **Przycisk "Od nowa".** Aby zresetowa aplikacj i rozpocz now konwersj, kliknij przycisk **"Od nowa"**. Spowoduje to wyczyszczenie wszystkich danych, w tym wczytanego pliku PDF, zakresu stron i wynik贸w konwersji. Aplikacja zostanie przywr贸cona do stanu pocztkowego.

## Przykad U偶ycia z Raportem ENEA

Poni偶ej przedstawiono przykad u偶ycia aplikacji z raportem ENEA "Publikacja podmiot贸w 31_12_2024r.pdf", kt贸rego URL zosta podany:

`https://operator.enea.pl/uploads-ev2/Operator/ospolce/raporty/Publikacja_podmiot%C3%B3w_31_12_2024r..pdf`

1.  **Uruchom aplikacj PDF to CSV Converter.**
2.  **Wprowad藕 klucz API Gemini** (lub upewnij si, 偶e zmienna rodowiskowa `GEMINI_API_KEY` jest ustawiona).
3.  **Wybierz "Enter PDF URL".**
4.  **Wklej URL raportu ENEA** w polu "Enter PDF URL:":
    ```
    https://operator.enea.pl/uploads-ev2/Operator/ospolce/raporty/Publikacja_podmiot%C3%B3w_31_12_2024r..pdf
    ```
5.  **Ustaw zakres stron.** Domylnie aplikacja powinna wczyta cay raport. Mo偶esz dostosowa zakres stron, jeli chcesz przetworzy tylko wybrane strony. Na przykad, aby przetworzy strony od 1 do 5, ustaw "Start Page" na 1 i "End Page" na 5.
6.  **Kliknij "Convert".**
7.  **Poczekaj na zakoczenie konwersji.** Aplikacja bdzie przetwarza strony raportu i wywietla wyniki w tabeli.
8.  **Pobierz plik CSV.** Po zakoczeniu konwersji, kliknij "Download CSV", aby zapisa wygenerowany plik CSV z danymi z raportu ENEA.

## Kluczowe Funkcje Aplikacji

*   **Wsparcie Gemini API:** Wykorzystanie zaawansowanego modelu jzykowego Gemini do dokadnej ekstrakcji danych tabelarycznych.
*   **Elastyczno 藕r贸da PDF:** Mo偶liwo wczytywania PDF zar贸wno z plik贸w lokalnych, jak i URL-i.
*   **Precyzyjny zakres stron:** U偶ytkownik ma pen kontrol nad zakresem stron do konwersji.
*   **Interaktywny interfejs:** Streamlit zapewnia intuicyjny i responsywny interfejs u偶ytkownika.
*   **Dynamiczne wywietlanie tabeli:** Wyniki konwersji s prezentowane w formie tabeli na bie偶co.
*   **Wska藕niki postpu:** Informacje o postpie, czasie i prdkoci przetwarzania zapewniaj lepsze dowiadczenie u偶ytkownika.
*   **Opcja zatrzymania i resetu:** Umo偶liwia u偶ytkownikowi kontrol nad procesem i atwe rozpoczcie nowej konwersji.

## Zale偶noci i Konfiguracja

**Zale偶noci:**

*   `streamlit`
*   `PyPDF2`
*   `requests`
*   `python-dotenv`
*   `google-generativeai`
*   `pandas`
*   `csv`
*   `stqdm`

**Konfiguracja:**

*   **Klucz API Gemini:** Wymagany klucz API Gemini, kt贸ry mo偶na wprowadzi w aplikacji lub ustawi jako zmienn rodowiskow `GEMINI_API_KEY`.
*   **Zmienne rodowiskowe:** Opcjonalnie, ustaw zmienn rodowiskow `GEMINI_API_KEY` zamiast wprowadzania klucza API w aplikacji.

## Rozwizywanie Problem贸w

*   **Bd API Key:** Jeli aplikacja wywietla bd zwizany z kluczem API, upewnij si, 偶e klucz zosta poprawnie wprowadzony lub zmienna rodowiskowa `GEMINI_API_KEY` jest poprawnie ustawiona. Sprawd藕, czy klucz API jest aktywny w Google AI Studio.
*   **Bd odczytu PDF:** Jeli aplikacja nie mo偶e odczyta pliku PDF lub URL, upewnij si, 偶e plik PDF nie jest uszkodzony i URL jest poprawny oraz dostpny. W przypadku URL, sprawd藕 poczenie internetowe.
*   **Bd parsowania CSV:** Jeli aplikacja wywietla ostrze偶enia dotyczce parsowania CSV z niekt贸rych stron, oznacza to, 偶e model Gemini API m贸g niepoprawnie wygenerowa format CSV dla tych stron. Sprawd藕 surowy output CSV (w opcjonalnym polu tekstowym, jeli jest wczone) i spr贸buj ponownie przekonwertowa te strony lub dostosowa zakres stron.
*   **Niska prdko konwersji:** Prdko konwersji zale偶y od obci偶enia serwer贸w Gemini API i szybkoci poczenia internetowego. Aplikacja ma wbudowane op贸藕nienie midzy zapytaniami (6 sekund), aby unikn przekroczenia limitu zapyta API.
*   **Niekompletne dane CSV:** W przypadku bardzo skomplikowanych tabel w PDF, model Gemini API mo偶e nie wyekstrahowa wszystkich danych poprawnie. Sprawd藕 wygenerowany plik CSV i por贸wnaj go z oryginalnym PDF, aby zidentyfikowa ewentualne braki lub bdy. W takim przypadku, mo偶e by konieczne rczne poprawienie pliku CSV.

Mam nadziej, 偶e ta dokumentacja jest pomocna w korzystaniu z aplikacji PDF to CSV Converter! Jeli masz jakiekolwiek pytania, uwagi lub sugestie, daj mi zna. Dzikuj za korzystanie z aplikacji i 偶ycz owocnej konwersji PDF na CSV! ★